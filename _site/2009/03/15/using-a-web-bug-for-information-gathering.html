<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title> Using a web bug for information gathering </title>
    <meta name="description" content="Abstract:Any one can post an image anywhere that allows the posting of remote images, grab the http header information of any one who views the image and sav...">

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-60x60.png" />
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://dewhurstsecurity.com/img/favicomatic/img/favicomatic/apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-152x152.png" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-196x196.png" sizes="196x196" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-16x16.png" sizes="16x16" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-128.png" sizes="128x128" />
	<meta name="application-name" content="&nbsp;"/>
	<meta name="msapplication-TileColor" content="#FFFFFF" />
	<meta name="msapplication-TileImage" content="https://dewhurstsecurity.com/img/favicomatic/mstile-144x144.png" />
	<meta name="msapplication-square70x70logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-70x70.png" />
	<meta name="msapplication-square150x150logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-150x150.png" />
	<meta name="msapplication-wide310x150logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-310x150.png" />
	<meta name="msapplication-square310x310logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-310x310.png" />

</head>
<body class="home-template">


    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="https://blog.dewhurstsecurity.com">
                
                    <span class="blog-title">Dewhurst Security Blog</span>
                
            </a>
        </header>

        <span class="post-meta">
        	<time datetime="2009-03-15">15 Mar 2009</time>
        	
        		on
	        	
	        
       	</span>

        <h1 class="post-title">Using a web bug for information gathering</h1>

        <section class="post-content">
            <p>Abstract:<br />
Any one can post an image anywhere that allows the posting of remote images, grab the http header information of any one who views the image and save it to a log file on a remote server. This has been done for a while by the advertisement industry to track users activities. It can also be used by mail clients to check that an email has been read by the recipient. It is known as a 'web bug'.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>How its done:</p>
<p>1. You need a php script that will capture the GET HTTP headers, echo an image and have the content-type header set as a jpg.</p>
<p>2. A directory called /image.jpg/</p>
<p>3. htaccess file to automatically load index files within directories</p>
<p>3. Some where you can post the &lt;img&gt; HTML tag.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>Exploit:</p>
<p>Post the following code into any forum, blog, guestbook, website that accepts images from remote servers.</p>
<p>&lt;img&gt;<a href="http://www.mysite.com/image.jpg" target="_blank">http://www.mysite.com/image.jpg</a>&lt;/img&gt;<br />
OR<br />
&lt;img src="<a href="http://www.mysite.com/image.jpg" target="_blank">http://www.mysite.com/image.jpg</a>"&gt;</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>How it works:</p>
<p><a id="more"></a><a id="more-160"></a></p>
<p>The php script has a jpg header, echos an image and stores http header information to a log file. This is great but still has the .php extension rather than the .jpg extension.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>You create a directory called /image.jpg/</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>You tell the htaccess to show any file named index when you access the /image.jpg/ directory. So when you access <a href="http://www.mysite.com/image.jpg" target="_blank">www.mysite.com/image.jpg</a> it will automatically load the php script (index.php) which looks like an ordinary jpg.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>So we now have a php script that acts and looks like an image, that records http headers and we also have it looking like it has the .jpg extension rather than the .php extension.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>So what you can do is post the image.jpg directory to a forum as an image and it will record any one who views its http header information. e.i. ip, referer, user-agent, etc...</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>Impact:</p>
<p>You can grab sensitive information from any one you can social engineer into viewing an image.</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p><span style="color: #ff0000;">This is legal behaviour however maybe considerd unethical depending on the intent of the person doing it. I have not included the PHP file that stores the GET HTTP header information due to posible misuse.<br />
</span></p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>So far it has been tested on:</p>
<p>vBulletin 3.8.1 - in posts - not in avatar<br />
vBulletin 3.6.8 - in posts - not in avatar<br />
phpBB 3.0.3 - in post - in avatar<br />
Facebook - not vulnerable<br />
imageshack - not vulnerable<br />
Joomla com jomcomment - Vulnerable</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>More info:</p>
<p><a title="wikipedia web bug" href="http://en.wikipedia.org/wiki/Web_bug" target="_blank">http://en.wikipedia.org/wiki/Web_bug</a></p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>As for the post underneath about weather or not what the BBC did was legal or illegal, in short it was illegal however who's going to legally challenge them?</p>
<p><strong><span style="text-decoration: underline;"></span><br />
</strong></p>
<p>Here's a good debate on the topic:</p>
<p><a title="guardian bbc legality" href="http://www.guardian.co.uk/technology/blog/2009/mar/12/bbc-botnet-legality-questioned" target="_blank">http://www.guardian.co.uk/technology/blog/2009/mar/12/bbc-botnet-legality-questioned</a></p>

        </section>

        

        <footer class="post-footer">
            <section class="hire-me">
              <h4><a href="https://dewhurstsecurity.com/" onClick="_gaq.push(['_trackEvent', 'External Link', 'Dewhurst Security Link', 'Hire Us â€“ Words']);">Hire Us</a></h4>
            </section>

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=Using a web bug for information gathering&amp;url=https://blog.dewhurstsecurity.com/2009/03/15/using-a-web-bug-for-information-gathering.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.dewhurstsecurity.com/2009/03/15/using-a-web-bug-for-information-gathering.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://blog.dewhurstsecurity.com/2009/03/15/using-a-web-bug-for-information-gathering.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>

    </article>

</main>


    <footer class="site-footer">
        <div class="inner">
            <section class="copyright">All content copyright <a href="https://dewhurstsecurity.com">Dewhurst Security</a> &copy;  &bull; All rights reserved.</section>
        </div>
    </footer>


    <script type="text/javascript" src="/assets/js/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3292649-12', 'auto');
      ga('send', 'pageview');
    </script>

</body>
</html>

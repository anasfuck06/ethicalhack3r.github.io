<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title> ExploitBox WordPress Security Advisories </title>
    <meta name="description" content="Yesterday, May 3rd 2017, a site named ExploitBox released two WordPress advisories discovered by Dawid Golunski. The titles of the two advisories are: WordPr...">

    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/css/normalize.css" />
    <link rel="stylesheet" type="text/css" href="/assets/css/screen.css" />
    <link rel="stylesheet" type="text/css" href="//fonts.googleapis.com/css?family=Noto+Serif:400,700,400italic|Open+Sans:700,400" />
    <!-- This is for syntax highlight -->
    <link rel="stylesheet" type="text/css" href="/assets/css/syntax.css">
    <!-- Customisation  -->
    <link rel="stylesheet" type="text/css" href="/assets/css/main.css" />

    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-57x57.png" />
	<link rel="apple-touch-icon-precomposed" sizes="114x114" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-114x114.png" />
	<link rel="apple-touch-icon-precomposed" sizes="72x72" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-72x72.png" />
	<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-144x144.png" />
	<link rel="apple-touch-icon-precomposed" sizes="60x60" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-60x60.png" />
	<link rel="apple-touch-icon-precomposed" sizes="120x120" href="https://dewhurstsecurity.com/img/favicomatic/img/favicomatic/apple-touch-icon-120x120.png" />
	<link rel="apple-touch-icon-precomposed" sizes="76x76" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-76x76.png" />
	<link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://dewhurstsecurity.com/img/favicomatic/apple-touch-icon-152x152.png" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-196x196.png" sizes="196x196" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-96x96.png" sizes="96x96" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-32x32.png" sizes="32x32" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-16x16.png" sizes="16x16" />
	<link rel="icon" type="image/png" href="https://dewhurstsecurity.com/img/favicomatic/favicon-128.png" sizes="128x128" />
	<meta name="application-name" content="&nbsp;"/>
	<meta name="msapplication-TileColor" content="#FFFFFF" />
	<meta name="msapplication-TileImage" content="https://dewhurstsecurity.com/img/favicomatic/mstile-144x144.png" />
	<meta name="msapplication-square70x70logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-70x70.png" />
	<meta name="msapplication-square150x150logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-150x150.png" />
	<meta name="msapplication-wide310x150logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-310x150.png" />
	<meta name="msapplication-square310x310logo" content="https://dewhurstsecurity.com/img/favicomatic/mstile-310x310.png" />

</head>
<body class="home-template">


    <main class="content" role="main">

    <article class="post">
        <header class="post-header">
            <a id="blog-logo" href="https://blog.dewhurstsecurity.com">
                
                    <span class="blog-title">Dewhurst Security Blog</span>
                
            </a>
        </header>

        <span class="post-meta">
        	<time datetime="2017-05-04">04 May 2017</time>
        	
        		on
	        	
	        
       	</span>

        <h1 class="post-title">ExploitBox WordPress Security Advisories</h1>

        <section class="post-content">
            <p>Yesterday, May 3rd 2017, a site named ExploitBox released two WordPress advisories discovered by Dawid Golunski. The titles of the two advisories are:</p>

<ul>
  <li><a href="https://exploitbox.io/vuln/WordPress-Exploit-4-7-Unauth-Password-Reset-0day-CVE-2017-8295.html">WordPress Core &lt;= 4.7.4 Potential Unauthorized Password Reset (0day)</a> (CVE-2017-8295)</li>
  <li><a href="https://exploitbox.io/vuln/WordPress-Exploit-4-6-RCE-CODE-EXEC-CVE-2016-10033.html">WordPress Core 4.6 - Unauthenticated Remote Code Execution (RCE) PoC Exploit (default configuration, no plugins, no auth)</a> (CVE-2016-10033)</li>
</ul>

<h3 id="wordpress-core--474-potential-unauthorized-password-reset-0day">WordPress Core &lt;= 4.7.4 Potential Unauthorized Password Reset (0day)</h3>

<p>The first advisory documents a <em>potential</em> unauthorized password reset vulnerability in the latest version of WordPress (4.7.4 at the time of writing) and below.</p>

<p>The issue documented is due to WordPress using the <code class="highlighter-rouge">SERVER_NAME</code> PHP variable, which uses the HTTP <code class="highlighter-rouge">Host</code> request header by default, to construct the <code class="highlighter-rouge">from</code> (or Return-Path) email address when requesting a password reset email. This vulnerability is commonly known as ‘host header injection’. To exploit this vulnerability, in this particular case, an unauthenticated attacker could request a password reset for a particular user (‘admin’ being the obvious choice) while changing the <code class="highlighter-rouge">Host</code> HTTP request header value to a domain the attacker controls. Under the right circumstances, a password reset email would then be sent to the victim user with the <code class="highlighter-rouge">from</code> email header set to the attacker’s domain.</p>

<p>To successfully exploit this issue, the WordPress user receiving the malicious password reset email would need to somehow reply to the email. The advisory author suggests some scenarios where the password reset email may be replied to:</p>

<blockquote>
  <ul>
    <li>If attacker knows the email address of the victim user. They can perform a prior DoS attack on the victim’s email account (e.g by sending multiple large files to exceed user’s disk quota, or attacking the DNS server) in order to  cause the password reset email to be rejected by the receiving server, or not reach the destination and thus get returned to the account on attacker’s server</li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>Some autoresponders might attach a copy of the email sent in the body of the auto-replied message</li>
  </ul>
</blockquote>

<blockquote>
  <ul>
    <li>Sending multiple password reset emails to force the user to reply to the message to enquiry explanation for endless password reset emails. The reply containing the password link would then be sent to attacker.</li>
  </ul>
</blockquote>

<h4 id="risk">Risk</h4>

<p>Virtual hosting allows one web server to host multiple domains. For example, <code class="highlighter-rouge">somesite.com</code>, <code class="highlighter-rouge">anothersite.es</code> and <code class="highlighter-rouge">yetanothersite.fr</code> can all be hosted on the same server with the same IP address. To tell the server which domain you want to access you have to supply the domain in the <code class="highlighter-rouge">Host</code> HTTP request header. To exploit this issue the attacker must be able to control the <code class="highlighter-rouge">Host</code> HTTP request header, but then how does the server know which domain to serve you?</p>

<p>From what we can see, this vulnerability can only be exploited against the default virtual host. The virtual host (domain) the web server will default to. You are vulnerable if your domain running WordPress is the only domain on the server, or, if your domain is the default one. That coupled with the exploitation requirement for the victim to somehow respond to the email, we believe it is pretty unlikely that this will be a major issue affecting WordPress users. Nevertheless, under the correct circumstances, there is a risk here.</p>

<h4 id="remediation">Remediation</h4>

<p>This vulnerability can be prevented by setting the following directive in the main Apache configuration file <code class="highlighter-rouge">UseCanonicalName = On</code>. This will force PHP to use the configured <code class="highlighter-rouge">ServerName</code> directive value instead of relying on the HTTP <code class="highlighter-rouge">Host</code> request header which can be manipulated by an attacker.</p>

<p>WordPress could patch this issue by not using the <code class="highlighter-rouge">SERVER_NAME</code> variable to construct the <code class="highlighter-rouge">from</code> email header. This could be achieved by using the <code class="highlighter-rouge">siteurl</code> or <code class="highlighter-rouge">home</code> WordPress database values which are set at the time of installation.</p>

<h3 id="wordpress-core-46---unauthenticated-remote-code-execution-rce-poc-exploit-default-configuration-no-plugins-no-auth">WordPress Core 4.6 - Unauthenticated Remote Code Execution (RCE) PoC Exploit (default configuration, no plugins, no auth)</h3>

<p>The second advisory documents an unauthorized Remote Code Execution (RCE) PoC exploit in WordPress version 4.6 (released August 16th 2016).</p>

<p>This vulnerability is also due to WordPress using the <code class="highlighter-rouge">SERVER_NAME</code> PHP variable to set the <code class="highlighter-rouge">from</code> email header (which can be set with the <code class="highlighter-rouge">Host</code> HTTP request header).</p>

<p>The author of the advisory uses the host header injection vulnerability in WordPress to exploit a vulnerability the author previously discovered in <a href="https://github.com/PHPMailer/PHPMailer">PHPMailer</a> (used by WordPress to send email). Wordfence did a <a href="https://www.wordfence.com/blog/2016/12/phpmailer-vulnerability/">great write up</a> on the PHPMailer vulnerability when the details were first publicly released back in December 2016.</p>

<h4 id="risk-1">Risk</h4>

<p>The risk of this vulnerability compared to the previous one is much higher, as with this one an unauthenticated attacker could achieve Remote Code Execution (RCE), and it does not require any user interaction (user replying to the email, autoresponders or DoS). However, the PHPMailer vulnerability was patched in WordPress version 4.7.1. If you are using the latest version of WordPress, or any of the patched versions, then you are not affected by this issue. Please note that to exploit this vulnerability the <code class="highlighter-rouge">Host</code> HTTP request header must also be able to be manipulated, which may be difficult if the target WordPress blog is not the default (or first) virtual host (as discussed previously).</p>

<h4 id="remediation-1">Remediation</h4>

<p>The easiest way to mitigate this vulnerability is to update WordPress to the latest version (or any patched version), which you should be doing anyway. If you want to further harden your WordPress installation the remediation information given for the previous vulnerability should also be applied.</p>

        </section>

        

        <footer class="post-footer">
            <section class="hire-me">
              <h4><a href="https://dewhurstsecurity.com/" onClick="_gaq.push(['_trackEvent', 'External Link', 'Dewhurst Security Link', 'Hire Us – Words']);">Hire Us</a></h4>
            </section>

            <section class="share">
                <h4>Share this post</h4>
                <a class="icon-twitter" href="http://twitter.com/share?text=ExploitBox WordPress Security Advisories&amp;url=https://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html"
                    onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <span class="hidden">Twitter</span>
                </a>
                <a class="icon-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html"
                    onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <span class="hidden">Facebook</span>
                </a>
                <a class="icon-google-plus" href="https://plus.google.com/share?url=https://blog.dewhurstsecurity.com/2017/05/04/exploitbox-wordpress-security-advisories.html"
                   onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
                    <span class="hidden">Google+</span>
                </a>
            </section>

        </footer>

    </article>

</main>


    <footer class="site-footer">
        <div class="inner">
            <section class="copyright">All content copyright <a href="https://dewhurstsecurity.com">Dewhurst Security</a> &copy; 2019 &bull; All rights reserved.</section>
        </div>
    </footer>


    <script type="text/javascript" src="/assets/js/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="/assets/js/index.js"></script>

    <!-- Google Analytics -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3292649-12', 'auto');
      ga('send', 'pageview');
    </script>

</body>
</html>
